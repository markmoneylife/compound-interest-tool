<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å³é¦¬å…‹çš„è¤‡åˆ©è©¦ç®—å·¥å…·ï½œé¦¬å…‹ç†è²¡</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: 'Helvetica Neue', sans-serif;
      background-color: #F5F2E9;
      color: #1A1A1A;
      padding: 2rem;
      max-width: 1200px;
      margin: auto;
    }
    h1 {
      color: #2D3C2F;
      text-align: center;
    }
    .tagline {
      text-align: center;
      font-size: 1rem;
      color: #888;
      margin-top: -1rem;
      margin-bottom: 2rem;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      margin-top: 2rem;
    }
    .form-section, .table-section {
      flex: 1 1 400px;
      background-color: #F5F2E9;
      padding: 1rem;
      border-radius: 0.5rem;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 0.5rem;
    }
    button {
      margin-top: 1.5rem;
      background-color: #2D3C2F;
      color: white;
      border: none;
      padding: 0.7rem 1.2rem;
      border-radius: 0.5rem;
      cursor: pointer;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      padding: 0.5rem;
      border-bottom: 1px solid #ccc;
      text-align: right;
    }
    th {
      background-color: #FFD54F;
      color: #1A1A1A;
    }
    .highlight {
      background-color: #B2D7E7;
    }
    canvas {
      margin-top: 3rem;
    }
  </style>
</head>
<body>
  <header style="background-color:#2D3C2F; padding: 1rem 2rem; color: white; display: flex; justify-content: space-between; align-items: center; font-size: 1.2rem;">
    <div style="font-weight: bold;">å³é¦¬å…‹ï½œå¹¸ç¦ç†è²¡å®¶ å·¥å…·</div>
    <nav>
      <a href="https://markmoneylife.com/" style="color: white; margin-left: 1rem; text-decoration: none;">é¦–é </a>
      <a href="https://markmoneylife.com/%e7%b0%a1%e5%96%ae%e8%a8%88%e7%ae%97%ef%bc%8c%e8%bc%95%e9%ac%86%e7%90%86%e8%b2%a1%ef%bc%81/" style="color: white; margin-left: 1rem; text-decoration: none;">æŠ•è³‡å·¥å…·èˆ‡è³‡è¨Šç¶²ç«™åˆ†äº«</a>
      <a href="https://www.youtube.com/user/rengary" target="_blank" style="color: #FFD54F; margin-left: 1.5rem; text-decoration: none; font-weight: bold;">ğŸ“º YouTube é »é“</a>
    </nav>
  </header>

  <h1>è¤‡åˆ©è©¦ç®—å·¥å…·</h1>
  <p class="tagline">é¦¬å…‹ç†è²¡é »é“ Ã— é•·æœŸæŠ•è³‡ Ã— è‚¡æ¯ç´¯ç©è©¦ç®—</p>

  <div class="container">
    <div class="form-section">
      <label>ç›®å‰å¹´é½¡</label>
      <input type="number" id="startAge" value="25" />
      <label>é–‹å§‹å¹´ä»½</label>
      <input type="number" id="startYear" value="2025" />
      <label>é–‹å§‹æœˆä»½</label>
      <select id="startMonth">
        <option value="0">1 æœˆ</option>
        <option value="1">2 æœˆ</option>
        <option value="2">3 æœˆ</option>
        <option value="3">4 æœˆ</option>
        <option value="4">5 æœˆ</option>
        <option value="5">6 æœˆ</option>
        <option value="6">7 æœˆ</option>
        <option value="7">8 æœˆ</option>
        <option value="8">9 æœˆ</option>
        <option value="9">10 æœˆ</option>
        <option value="10">11 æœˆ</option>
        <option value="11">12 æœˆ</option>
      </select>
      <label>åˆå§‹é‡‘é¡</label>
      <input type="number" id="startAmount" value="0" />
      <label>æ¯æœˆæŠ•å…¥é‡‘é¡</label>
      <input type="number" id="monthly" value="10000" />
      <label>å¹´å ±é…¬ç‡ (%)</label>
      <input type="number" id="rate" value="6" />
      <label>é ä¼°é€€ä¼‘å¹´é½¡</label>
      <input type="number" id="retireAge" value="45" />
      <label><input type="checkbox" id="reinvestDividend" checked /> é…æ¯å†æŠ•å…¥</label>
      <button onclick="calculateGrowth()">è¨ˆç®—</button>
      <button onclick="downloadExcel()">åŒ¯å‡º Excel</button>
    </div>

    <div class="table-section">
      <table id="resultTable">
        <thead>
          <tr>
            <th>å¹´é½¡</th>
            <th>å¹´ä»½</th>
            <th>æŠ•å…¥é‡‘é¡</th>
            <th>ç´¯ç©é‡‘é¡</th>
            <th>é ä¼°é…æ¯</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <canvas id="stackedChart" height="120"></canvas>

  <footer style="margin-top: 4rem; text-align: center; font-size: 0.9rem; color: #888;">
    æœ¬å·¥å…·ç”± <strong>å³é¦¬å…‹ï½œå¹¸ç¦ç†è²¡å®¶</strong> è£½ä½œï½œ<a href="https://markmoneylife.com/" target="_blank">è¿”å›ä¸»ç¶²ç«™</a>
  </footer>

  <script>
    let exportData = [];

    function calculateGrowth() {
      const startAge = parseInt(document.getElementById("startAge").value);
      const startYear = parseInt(document.getElementById("startYear").value);
      const startMonth = parseInt(document.getElementById("startMonth").value);
      const startAmount = parseFloat(document.getElementById("startAmount").value);
      const monthly = parseFloat(document.getElementById("monthly").value);
      const rate = parseFloat(document.getElementById("rate").value) / 100 / 12;
      const retireAge = parseInt(document.getElementById("retireAge").value);
      const reinvest = document.getElementById("reinvestDividend").checked;
      const years = retireAge - startAge;

      let total = startAmount, dividendTotal = 0;
      const data = [], labels = [], invested = [];
      exportData = [];
      const tableBody = document.querySelector("#resultTable tbody");
      tableBody.innerHTML = "";

      for (let i = 0; i <= years * 12; i++) {
        const yearIndex = Math.floor((i + startMonth) / 12);
        const year = startYear + yearIndex;
        const age = startAge + yearIndex;

        let dividend = total * 0.06 / 12;
        dividendTotal += dividend;
        if (reinvest) total += dividend;

        total = total * (1 + rate) + monthly;

        if ((i + startMonth + 1) % 12 === 0) {
          const months = i + 1;
          const investedAmount = startAmount + monthly * months;
          data.push(total);
          invested.push(investedAmount);
          labels.push(`ç¬¬${yearIndex + 1}å¹´`);

          tableBody.innerHTML += `<tr>
            <td>${age}</td>
            <td>${year}</td>
            <td>$${investedAmount.toLocaleString()}</td>
            <td>$${Math.round(total).toLocaleString()}</td>
            <td>$${Math.round(total * 0.06).toLocaleString()}</td>
          </tr>`;

          exportData.push({ å¹´é½¡: age, å¹´ä»½: year, æŠ•å…¥é‡‘é¡: investedAmount, ç´¯ç©é‡‘é¡: Math.round(total), é ä¼°é…æ¯: Math.round(total * 0.06) });
        }
      }

      tableBody.innerHTML += `<tr style="font-weight:bold; background:#eee">
        <td colspan="2">ç¸½è¨ˆ</td>
        <td>$${invested[invested.length - 1].toLocaleString()}</td>
        <td></td>
        <td>$${Math.round(dividendTotal).toLocaleString()}</td>
      </tr>`;

      new Chart(document.getElementById("stackedChart"), {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [
            {
              label: "æŠ•å…¥è³‡é‡‘",
              data: invested,
              backgroundColor: "#B2D7E7"
            },
            {
              label: "ç´¯ç©é‡‘é¡å¢å€¼",
              data: data.map((v, i) => v - invested[i]),
              backgroundColor: "#FFD54F"
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: 'æŠ•å…¥èˆ‡å¢å€¼é‡‘é¡å †ç–Šåœ–'
            },
            tooltip: {
              mode: 'index',
              intersect: false
            },
          },
          scales: {
            x: { stacked: true },
            y: { stacked: true }
          }
        }
      });
    }

    function downloadExcel() {
      const ws = XLSX.utils.json_to_sheet(exportData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "è¤‡åˆ©è©¦ç®—");
      XLSX.writeFile(wb, "compound-growth.xlsx");
    }
  </script>
</body>
</html>
