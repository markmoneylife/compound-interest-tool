<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ETF æŠ•è³‡ç¸¾æ•ˆç‰†ï½œé¦¬æ¿•å…‹ 300 æœƒå“¡å°ˆå±¬</title>

<!-- PapaParseï¼šé¿å… CSV æ¬„ä½éŒ¯ä½ -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
  :root {
    --dark: #004d40;
    --light: #ffeb3b;
    --bg: #f7f8fa;
    --text: #333;
    --red: #C0392B;
    --green: #1D4A35;
    --yellow: #C59A00;
    --card: #ffffff;
  }

  body {
    margin: 0;
    background: var(--bg);
    font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
    color: var(--text);
    line-height: 1.55;
  }

  header {
    padding: 1.5rem 1rem;
    background: var(--dark);
    color: #fff;
    text-align: center;
  }

  header h1 {
    font-size: 1.8rem;
    margin: .2rem 0;
  }

  header p {
    font-size: .95rem;
    margin-top: .4rem;
    color: #f2f2f2;
  }

  .container {
    max-width: 1100px;
    margin: 1.5rem auto;
    padding: 0 1rem;
  }

  /* è¿”å›æŒ‰éˆ• */
  .back-btn {
    display: inline-block;
    margin-bottom: 1rem;
    background: var(--dark);
    color: #fff;
    padding: .55rem 1rem;
    border-radius: 6px;
    text-decoration: none;
    font-size: .9rem;
    font-weight: bold;
  }

  .summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
    gap: 1rem;
    margin-top: .8rem;
  }

  .summary-card {
    background: var(--card);
    padding: 1rem;
    border-radius: 14px;
    box-shadow: 0 3px 7px rgba(0,0,0,.08);
    border-left: 6px solid var(--dark);
  }

  .summary-card h3 {
    font-size: .9rem;
    color: #666;
    margin-bottom: .25rem;
  }

  .value {
    font-size: 1.4rem;
    font-weight: 700;
  }

  .positive { color: var(--red); }
  .negative { color: var(--green); }

  /* å¡ç‰‡ */
  .cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px,1fr));
    gap: 1rem;
    margin-top: 1.5rem;
  }

  .etf-card {
    background: #fff;
    padding: 1rem;
    border-radius: 14px;
    box-shadow: 0 3px 8px rgba(0,0,0,.08);
  }

  .etf-title {
    font-size: 1.15rem;
    font-weight: 700;
    margin-bottom: .4rem;
  }

  .metric-label {
    font-size: .8rem;
    color: #777;
    margin-top: .7rem;
  }

  .metric-value {
    font-size: .95rem;
    font-weight: 700;
  }

  /* ä¼°å€¼ç‡ˆè™Ÿ */
  .signal-cheap { color: var(--green); font-weight: bold; }
  .signal-fair { color: var(--yellow); font-weight: bold; }
  .signal-expensive { color: var(--red); font-weight: bold; }

  .etf-footer {
    margin-top: .7rem;
    padding-top: .6rem;
    border-top: 1px dashed #ccc;
    font-size: .8rem;
    color: #666;
    text-align: right;
  }

  footer {
    text-align: center;
    margin: 2rem 0 1rem;
    font-size: .85rem;
    color: #777;
  }
</style>
</head>

<body>

<!-- ğŸ›¡ æœƒå“¡å®ˆé–€ï¼šä¸æ˜¯å¾ 300 ä¸»é ä¾†çš„ â†’ å…¨éƒ¨è¸¢å› -->
<script>
  if (document.referrer.indexOf("wumark-x-core300") === -1) {
    window.location.href = "wumark-x-core300.html";
  }
</script>

<header>
  <h1>ğŸ“Š ETF æŠ•è³‡ç¸¾æ•ˆç‰†</h1>
  <p>300 æœƒå“¡é™å®šï½œå…¬é–‹æˆ‘çš„çœŸå¯¦æˆæœ¬ã€å ±é…¬ã€é…æ¯èˆ‡ä¼°å€¼ç‡ˆè™Ÿ</p>
</header>

<div class="container">

  <a class="back-btn" href="wumark-x-core300.html">â† è¿”å› 300 æœƒå“¡ä¸»é </a>

  <div id="summaryArea" class="summary-grid"></div>

  <div id="cardsContainer" class="cards-grid"></div>

  <footer>
    âš ï¸ æœ¬é ç‚ºé¦¬å…‹å€‹äºº ETF æŠ•è³‡ç´€éŒ„ï¼Œä¸æ§‹æˆæŠ•è³‡å»ºè­°ã€‚æŠ•è³‡ä¸€å®šæœ‰é¢¨éšªï¼Œè«‹è‡ªä¸»åˆ¤æ–·ã€‚
  </footer>

</div>

<script>
const CSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vSYJzDEa1_U_eq_Wh_Sr6VcSLENN2-Uit1wHBmx5qZS_-2EOg0WNAeSBg1lK4blObR3R88nH08j074W/pub?gid=2137337223&single=true&output=csv";

function fmt(n){ return Number(n||0).toLocaleString("zh-TW"); }
function pct(n){ return Number(n).toFixed(2)+"%"; }

async function init(){
  const res = await fetch(CSV_URL);
  const text = await res.text();

  const parsed = Papa.parse(text, {
    header: true,
    skipEmptyLines: true
  });

  const etfs = parsed.data
    .filter(r => r["è‚¡è™Ÿ"] && r["è‚¡è™Ÿ"].trim() !== "")
    .map(r => ({
      ticker: r["è‚¡è™Ÿ"],
      name: r["è‚¡ç¥¨åç¨±"],
      cost: Number(r["ç¸½æŠ•è³‡æˆæœ¬"]||0),
      market: Number(r["å¸‚å€¼"]||0),
      returnPct: Number((r["å ±é…¬ç‡"]||"0").replace("%","")),
      cheap: r["ä¾¿å®œåƒ¹"],
      fair: r["åˆç†åƒ¹"],
      expensive: r["æ˜‚è²´åƒ¹"],
      signal: r["ä¼°å€¼ç‡ˆè™Ÿ"],
      totalDiv: Number(r["ç´¯ç©è‚¡æ¯ç¸½é¡"]||0),
      freq: r["é…æ¯é »ç‡"],
      update: r["æ›´æ–°æ—¥æœŸ"]
    }));

  renderSummary(etfs);
  renderCards(etfs);
}

function renderSummary(etfs){
  const box=document.getElementById("summaryArea");

  const totalCost=etfs.reduce((s,e)=>s+e.cost,0);
  const totalMarket=etfs.reduce((s,e)=>s+e.market,0);
  const totalDiv=etfs.reduce((s,e)=>s+e.totalDiv,0);
  const ret=totalCost>0?(totalMarket-totalCost)/totalCost*100:0;

  const data=[
    ["ç¸½å¸‚å€¼","NT$ "+fmt(totalMarket),""],
    ["ç¸½æŠ•å…¥æˆæœ¬","NT$ "+fmt(totalCost),""],
    ["æ•´é«”å«æ¯å ±é…¬ç‡",pct(ret),ret>=0?"positive":"negative"],
    ["ç´¯ç©å·²é ˜è‚¡æ¯","NT$ "+fmt(totalDiv),""]
  ];

  data.forEach(d=>{
    const card=document.createElement("div");
    card.className="summary-card";
    card.innerHTML=`
      <h3>${d[0]}</h3>
      <div class="value ${d[2]}">${d[1]}</div>
    `;
    box.appendChild(card);
  });
}

function renderCards(etfs){
  const box=document.getElementById("cardsContainer");

  etfs.forEach(e=>{
    let sigClass="";
    if(e.signal?.includes("ä¾¿å®œ")) sigClass="signal-cheap";
    else if(e.signal?.includes("åˆç†")) sigClass="signal-fair";
    else if(e.signal?.includes("æ˜‚è²´")) sigClass="signal-expensive";

    const card=document.createElement("div");
    card.className="etf-card";
    card.innerHTML=`
      <div class="etf-title">${e.ticker}ï½œ${e.name}</div>

      <div class="metric-label">å«æ¯å ±é…¬ç‡</div>
      <div class="metric-value ${e.returnPct>=0?"positive":"negative"}">${pct(e.returnPct)}</div>

      <div class="metric-label">å¸‚å€¼ / æˆæœ¬</div>
      <div class="metric-value">NT$ ${fmt(e.market)} ï¼ ${fmt(e.cost)}</div>

      <div class="metric-label">ä¼°å€¼ç‡ˆè™Ÿ</div>
      <div class="metric-value ${sigClass}">${e.signal||"-"}</div>

      <div class="metric-label">ä¾¿å®œåƒ¹ / åˆç†åƒ¹ / æ˜‚è²´åƒ¹</div>
      <div class="metric-value">${e.cheap||"-"} ï¼ ${e.fair||"-"} ï¼ ${e.expensive||"-"}</div>

      <div class="metric-label">ç´¯ç©å·²é ˜è‚¡æ¯</div>
      <div class="metric-value">NT$ ${fmt(e.totalDiv)}</div>
      <div class="metric-label">${e.freq?`é…æ¯é »ç‡ï¼š${e.freq}`:""}</div>

      <div class="etf-footer">æ›´æ–°ï¼š${e.update||"-"}</div>
    `;
    box.appendChild(card);
  });
}

init();
</script>

</body>
</html>
