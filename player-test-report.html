<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>é‹å‹•å“¡è¨“ç·´æˆæ•ˆå ±å‘Š v4.5</title>

  <!-- Chart.js & PapaParse -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

  <style>
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background: #f4f7f6;
      color: #333;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: #ffffff;
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    h1 {
      text-align: center;
      color: #2c3e50;
      margin-top: 0;
    }
    .controls {
      text-align: center;
      margin-bottom: 30px;
    }
    select {
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ddd;
      min-width: 220px;
    }
    .btn {
      padding: 8px 14px;
      border-radius: 6px;
      border: 1px solid #ddd;
      background: #ffffff;
      cursor: pointer;
      font-size: 14px;
      margin-left: 6px;
    }
    .btn:hover { background: #f3f4f6; }
    .btn:disabled { opacity: 0.6; cursor: default; }

    .report-section { display: none; }
    .info-card {
      background: #eef2f3;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }
    .info-item {
      text-align: center;
      flex: 1 1 30%;
      min-width: 150px;
    }
    .info-item h3 {
      margin: 0 0 5px 0;
      color: #7f8c8d;
      font-size: 14px;
    }
    .info-item p {
      margin: 0;
      font-weight: bold;
      font-size: 18px;
    }

    h2.section {
      border-left: 5px solid #3498db;
      padding-left: 10px;
      margin-top: 30px;
      margin-bottom: 10px;
      font-size: 20px;
    }
    h2.section.green {
      border-color: #27ae60;
    }

    .chart-container {
      position: relative;
      height: 400px;
      width: 100%;
      margin-top: 10px;
    }

    .coach-box {
      background: #fff8e1;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid #ffe0b2;
      font-size: 15px;
      line-height: 1.6;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 13px;
    }
    th, td {
      padding: 6px 8px;
      border-bottom: 1px solid #e5e7eb;
      text-align: right;
      white-space: nowrap;
    }
    th:first-child, td:first-child {
      text-align: left;
    }
    th {
      background: #f9fafb;
      color: #6b7280;
      font-weight: 500;
    }
    tr:last-child td {
      border-bottom: none;
    }

    .tag {
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid transparent;
      font-size: 12px;
    }
    .tag.good {
      border-color: rgba(16, 185, 129, 0.9);
      background: #d1fae5;
      color: #047857;
    }
    .tag.mid {
      border-color: rgba(245, 158, 11, 0.9);
      background: #fef9c3;
      color: #92400e;
    }
    .tag.bad {
      border-color: rgba(248, 113, 113, 0.9);
      background: #fee2e2;
      color: #b91c1c;
    }

    .btn-print {
      display: block;
      width: 100%;
      padding: 15px;
      background: #3498db;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      cursor: pointer;
      margin-top: 30px;
    }
    .btn-print:hover { background: #2980b9; }

    .note {
      font-size: 12px;
      color: #6b7280;
      margin-top: 6px;
    }

    @media print {
      body { background: white; padding: 0; }
      .container { box-shadow: none; width: 100%; max-width: 100%; padding: 20px; }
      .controls, .btn-print { display: none; }
      .report-section { display: block !important; }
      .chart-container { page-break-inside: avoid; }
    }
  </style>
</head>
<body>
<div class="container">
  <h1>ğŸ† é‹å‹•å“¡æª¢æ¸¬å ±å‘Šæ›¸</h1>

  <div class="controls">
    <label>è«‹é¸æ“‡é‹å‹•å“¡å§“åï¼š</label>
    <select id="studentSelect" disabled onchange="loadStudentData()">
      <option value="">è³‡æ–™è¼‰å…¥ä¸­...</option>
    </select>
    <button class="btn" id="reloadBtn" onclick="reloadSheets()">é‡æ–°è¼‰å…¥è©¦ç®—è¡¨</button>
  </div>

  <div id="report" class="report-section">
    <div class="info-card">
      <div class="info-item">
        <h3>å§“å</h3>
        <p id="dispName">-</p>
      </div>
      <div class="info-item">
        <h3>çµ„åˆ¥</h3>
        <p id="dispGroup">-</p>
      </div>
      <div class="info-item">
        <h3>æœ€è¿‘æª¢æ¸¬æ—¥</h3>
        <p id="dispDate">-</p>
      </div>
    </div>

    <h2 class="section">èƒ½åŠ›é›·é”åˆ†æ</h2>
    <p id="radarNote">
      æ­¤åœ–è¡¨å°‡æœ¬æ¬¡å„é …æˆç¸¾è½‰æ›æˆ 0â€“100 åˆ†ï¼Œåªçœ‹é€™æ¬¡æª¢æ¸¬ä¸­ã€Œè‡ªå·±å„é …èƒ½åŠ›çš„ç›¸å°å¼·å¼±ã€ï¼Œ
      ç§’æ•¸é¡ï¼ˆè¶ŠçŸ­è¶Šå¥½ï¼‰æœƒè‡ªå‹•åå‘è™•ç†ã€‚
    </p>
    <div class="chart-container">
      <canvas id="radarChart"></canvas>
    </div>

    <h2 class="section green">æ•™ç·´å»ºè­°èˆ‡çŸ­è©•</h2>
    <div class="coach-box">
      <p id="coachComment">
        è«‹å…ˆé¸æ“‡é‹å‹•å“¡ï¼Œç³»çµ±æœƒä¾ç…§æœ¬æ¬¡æª¢æ¸¬èˆ‡åœ‹éš›åƒè€ƒå€¼çš„å·®è·ï¼Œè‡ªå‹•æ•´ç†å¼·é …èˆ‡å»ºè­°è£œå¼·æ–¹å‘ã€‚
      </p>
    </div>

    <h2 class="section" style="margin-top:35px;">æœ¬æ¬¡æª¢æ¸¬æˆç¸¾èˆ‡åœ‹éš›æ¨™æº–å°ç…§</h2>
    <p class="note">
      åœ‹éš›åƒè€ƒå€¼ç”±ã€Œåœ‹éš›æ¨™æº–ã€åˆ†é ä¸­çš„å€é–“ä¸­é»ä¼°ç®—è€Œå¾—ï¼›è‹¥åŒæ™‚å…·å‚™ã€Œ(æ¨™æº–å·®)ï¼èª¤å·®ã€æ¬„ä½ï¼Œå‰‡å¯è¨ˆç®— Z åˆ†æ•¸ã€‚
      Z åˆ†æ•¸ç´„ä»‹æ–¼ -0.5 ï½ +0.5 è¦–ç‚ºæ¥è¿‘åœ‹éš›æ¨£æœ¬ï¼›â‰¥ +1 ç‚ºæ˜é¡¯å„ªæ–¼æ¨£æœ¬ï¼›â‰¤ -0.5 å»ºè­°åˆ—å…¥è£œå¼·é‡é»ã€‚
    </p>
    <table>
      <thead>
        <tr>
          <th>æŒ‡æ¨™</th>
          <th>å­¸ç”Ÿ</th>
          <th>åœ‹éš›åƒè€ƒå€¼</th>
          <th>SD</th>
          <th>Z åˆ†æ•¸</th>
          <th>è©•ä¼°</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>

    <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ åˆ—å° / å¦å­˜ç‚º PDF</button>
  </div>

  <p id="statusMsg" class="note"></p>
</div>

<script>
  // ======== è©¦ç®—è¡¨è¨­å®š ========
  const FILE_ID = "1N-8HQZaxHYj4vE824raG1fWyNxt5w7B9_m8oHn8f4As";
  const SHEETS = {
    players: "å­¸å“¡ä¸»è³‡æ–™è¡¨",
    tests: "æª¢æ¸¬æˆç¸¾",
    intl: "åœ‹éš›æ¨™æº–"
  };

  // ä¸ç•¶æˆé«”èƒ½æŒ‡æ¨™çš„æ¬„ä½
  const IDENTITY_KEYS = new Set([
    "å§“å","æ€§åˆ¥","å¹´é½¡","åˆ†ç´š","ç”Ÿæ—¥","æ—¥æœŸ","æ¸¬é©—æ—¥æœŸ",
    "å‚·ç—…ï¼é™åˆ¶","å‚·å‹¢ï¼é™åˆ¶","å‚·å‹¢/é™åˆ¶","ç›®æ¨™",
    "ä¸€é€±å¯ä¸Šèª²æ™‚æ®µ","è¯çµ¡æ–¹å¼","å‚™è¨»"
  ]);

  // ç§’æ•¸é¡ / åæ‡‰é¡ï¼šè¶Šå°è¶Šå¥½
  const LOWER_BETTER_KEYS = ["10", "20", "505", "åæ‡‰", "æ•æ·", "è¡åˆº", "s","S","ç§’"];

  function isLowerBetter(metricName) {
    return LOWER_BETTER_KEYS.some(k => metricName.includes(k));
  }

  // æ¬„ä½åç¨±æ¨™æº–åŒ–ï¼šå»ç©ºæ ¼ã€å…¨å½¢æ‹¬è™Ÿã€æ¨™æº–å·®/èª¤å·®å­—æ¨£
  function normalizeMetricName(name) {
    if (!name) return "";
    return String(name)
      .replace(/ï¼ˆ/g,"(").replace(/ï¼‰/g,")") // å…¨å½¢æ‹¬è™Ÿè½‰åŠå½¢
      .replace(/\s+/g,"")                  // å»æ‰æ‰€æœ‰ç©ºæ ¼
      .replace(/\(æ¨™æº–å·®\)/g,"")
      .replace(/\(èª¤å·®\)/g,"")
      .replace(/æ¨™æº–å·®/g,"")
      .replace(/èª¤å·®/g,"")
      .trim();
  }

  function csvUrlForSheet(sheetName) {
    return `https://docs.google.com/spreadsheets/d/${FILE_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(sheetName)}`;
  }

  // ä¸€èˆ¬æ¬„ä½ â†’ ç´”æ•¸å­—
  function parseNumber(v) {
    if (v == null || v === "") return null;
    const n = Number(String(v).replace(/[^\d.\-]/g, ""));
    return isNaN(n) ? null : n;
  }

  // åœ‹éš›æ¨™æº–ã€Œå€é–“ï¼‹å–®ä½ã€â†’ å–å‰å…©å€‹æ•¸å­—å¹³å‡ï¼Œæ²’æœ‰å€é–“å°±å–å–®ä¸€å€¼
  // e.g. "48 - 60+ CM" â†’ 54ï¼› "1.77 S" â†’ 1.77
  function parseIntlMean(v) {
    if (v == null || v === "") return null;
    const matches = String(v).match(/[\d.]+/g);
    if (!matches) return null;
    const nums = matches.map(Number).filter(n => !isNaN(n));
    if (!nums.length) return null;
    if (nums.length === 1) return nums[0];
    const firstTwo = nums.slice(0,2);
    const sum = firstTwo.reduce((a,b)=>a+b,0);
    return sum / firstTwo.length;
  }

  function zToScore(z) {
    const s = 50 + z * 10; // Z=0 -> 50 åˆ†
    return Math.max(0, Math.min(100, s));
  }

  let playersByName = new Map();
  let testsByName = new Map();
  let intlByGroup = new Map();
  let radarChart = null;

  function loadSheet(sheetName) {
    const url = csvUrlForSheet(sheetName);
    return new Promise((resolve, reject) => {
      Papa.parse(url, {
        download: true,
        header: true,
        complete: results => resolve(results.data),
        error: err => reject(err)
      });
    });
  }

  async function reloadSheets() {
    const status = document.getElementById("statusMsg");
    const select = document.getElementById("studentSelect");
    const report = document.getElementById("report");

    status.textContent = "å¾ Google è©¦ç®—è¡¨è¼‰å…¥ä¸­â€¦";
    select.disabled = true;
    select.innerHTML = '<option value="">è³‡æ–™è¼‰å…¥ä¸­...</option>';
    report.style.display = "none";

    try {
      const [players, tests, intl] = await Promise.all([
        loadSheet(SHEETS.players),
        loadSheet(SHEETS.tests),
        loadSheet(SHEETS.intl)
      ]);

      playersByName = new Map();
      testsByName = new Map();
      intlByGroup = new Map();

      players.forEach(row => {
        const n = (row["å§“å"] || "").trim();
        if (!n) return;
        playersByName.set(n, row);
      });

      tests.forEach(row => {
        const n = (row["å§“å"] || "").trim();
        if (!n) return;
        testsByName.set(n, row);
      });

      // åœ‹éš›æ¨™æº–ï¼šæ¯åˆ†ç´šä¸€åˆ—ï¼Œæ¬„ä½ = æŒ‡æ¨™ æˆ– æŒ‡æ¨™(æ¨™æº–å·®)
      intl.forEach(row => {
        const group = (row["åˆ†ç´š"] || "").trim();
        if (!group) return;
        const metrics = intlByGroup.get(group) || {};

        Object.keys(row).forEach(h => {
          if (!h || h === "åˆ†ç´š") return;
          const rawHeader = h;
          const isSD =
            rawHeader.includes("æ¨™æº–å·®") ||
            rawHeader.toUpperCase().includes("SD") ||
            rawHeader.includes("èª¤å·®");

          const keyNorm = normalizeMetricName(rawHeader);
          metrics[keyNorm] = metrics[keyNorm] || {};

          if (isSD) {
            const vSD = parseNumber(row[rawHeader]);
            if (vSD != null) metrics[keyNorm].sd = vSD;
          } else {
            const vMean = parseIntlMean(row[rawHeader]);
            if (vMean != null) metrics[keyNorm].mean = vMean;
          }
        });

        intlByGroup.set(group, metrics);
      });

      // ä¸‹æ‹‰é¸å–®ï¼šæœ‰æª¢æ¸¬æˆç¸¾çš„äºº
      const names = Array.from(testsByName.keys()).sort((a, b) =>
        a.localeCompare(b, "zh-Hant")
      );
      select.innerHTML = '<option value="">-- è«‹é¸æ“‡ --</option>';
      names.forEach(n => {
        const op = document.createElement("option");
        op.value = n;
        op.textContent = n;
        select.appendChild(op);
      });
      select.disabled = false;

      status.textContent = "è³‡æ–™è¼‰å…¥å®Œæˆï¼Œè«‹å¾ä¸Šæ–¹é¸æ“‡é‹å‹•å“¡ã€‚";
    } catch (err) {
      console.error(err);
      status.textContent =
        "è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ï¼š1ï¼‰è©¦ç®—è¡¨æ˜¯å¦å…¬é–‹ï¼›2ï¼‰åˆ†é åç¨±æ˜¯å¦ç‚ºã€Œå­¸å“¡ä¸»è³‡æ–™è¡¨ / æª¢æ¸¬æˆç¸¾ / åœ‹éš›æ¨™æº–ã€ã€‚";
    }
  }

  // é€²é å°±å…ˆè¼‰å…¥
  reloadSheets();

  function loadStudentData() {
    const name = document.getElementById("studentSelect").value;
    const report = document.getElementById("report");
    const status = document.getElementById("statusMsg");
    const radarNote = document.getElementById("radarNote");
    const canvas = document.getElementById("radarChart");

    if (!name) {
      report.style.display = "none";
      return;
    }

    const testRow = testsByName.get(name);
    if (!testRow) {
      status.textContent = `ã€Œ${name}ã€æ‰¾ä¸åˆ°æª¢æ¸¬æˆç¸¾ã€‚`;
      report.style.display = "none";
      return;
    }

    const playerRow = playersByName.get(name) || {};
    const group = playerRow["åˆ†ç´š"] || testRow["åˆ†ç´š"] || "-";
    const intlMetrics = intlByGroup.get(group) || {};

    // === åŸºæœ¬è³‡è¨Š ===
    document.getElementById("dispName").textContent = name;
    document.getElementById("dispGroup").textContent = group || "-";
    const date =
      playerRow["æœ€æ–°æª¢æ¸¬æ—¥"] ||
      testRow["æ—¥æœŸ"] ||
      testRow["æ¸¬é©—æ—¥æœŸ"] ||
      "";
    document.getElementById("dispDate").textContent = date || "-";

    // === æŒ‡æ¨™æ•´ç† ===
    const metricRows = [];
    Object.keys(testRow).forEach(key => {
      if (!key || IDENTITY_KEYS.has(key)) return;
      if (key.includes("æ¨™æº–å·®") || key.toUpperCase().includes("SD") || key.includes("èª¤å·®")) return;

      const latest = parseNumber(testRow[key]);
      if (latest == null) return;

      const normKey = normalizeMetricName(key);
      const intl = intlMetrics[normKey] || {};
      const mean = intl.mean ?? null;
      const sd = intl.sd ?? null;

      let z = null;
      let score = null;

      if (mean != null && sd != null && sd !== 0) {
        const lowerBetter = isLowerBetter(key);
        z = lowerBetter ? (mean - latest) / sd : (latest - mean) / sd;
        score = zToScore(z);
      }

      metricRows.push({
        label: key,
        normKey,
        latest,
        mean,
        sd,
        z,
        score
      });
    });

    if (!metricRows.length) {
      status.textContent =
        `ã€Œ${name}ã€çš„æª¢æ¸¬æˆç¸¾ç›®å‰æ²’æœ‰ä»»ä½•å¯è¦–ç‚ºæ•¸å€¼çš„æŒ‡æ¨™ï¼Œè«‹æª¢æŸ¥ã€Œæª¢æ¸¬æˆç¸¾ã€åˆ†é çš„æ¬„ä½ã€‚`;
      report.style.display = "none";
      return;
    }

    // === é›·é”åœ–ï¼šåªçœ‹ã€Œæœ¬æ¬¡æª¢æ¸¬å…§çš„ç›¸å°å¼·å¼±ã€ ===
    const usable = metricRows.filter(r => r.latest != null);
    let radarLabels = [];
    let radarPlayer = [];

    if (usable.length) {
      const processed = usable.map(r => {
        let v = r.latest;
        if (isLowerBetter(r.label)) v = -v; // æ™‚é–“è¶ŠçŸ­è¶Šé«˜åˆ†
        return { label: r.label, normBase: v };
      });

      const values = processed.map(p => p.normBase);
      const minVal = Math.min(...values);
      const maxVal = Math.max(...values);

      radarLabels = processed.map(p => p.label);
      radarPlayer = processed.map(p => {
        if (maxVal === minVal) return 50;
        return ((p.normBase - minVal) / (maxVal - minVal)) * 100;
      });

      radarNote.textContent =
        "é›·é”åœ–å·²å°‡ä¸åŒå–®ä½ï¼ˆcmã€ç§’æ•¸ç­‰ï¼‰è½‰æˆåŒä¸€å€‹ 0â€“100 åˆ†æ¨™æº–ï¼Œåªçœ‹é€™æ¬¡æª¢æ¸¬è£¡å„é …èƒ½åŠ›çš„ç›¸å°å¼·å¼±ï¼›ç§’æ•¸é¡ï¼ˆè¶ŠçŸ­è¶Šå¥½ï¼‰å·²è‡ªå‹•åå‘è™•ç†ã€‚";
    } else {
      radarLabels = [];
      radarPlayer = [];
      radarNote.textContent =
        "æ‰¾ä¸åˆ°å¯ç”¨çš„é«”èƒ½æŒ‡æ¨™ï¼Œç„¡æ³•ç¹ªè£½é›·é”åœ–ã€‚";
    }

    const ctx = canvas.getContext("2d");
    if (radarChart) radarChart.destroy();

    if (radarLabels.length === 0) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    } else {
      radarChart = new Chart(ctx, {
        type: "radar",
        data: {
          labels: radarLabels,
          datasets: [
            {
              label: name,
              data: radarPlayer,
              backgroundColor: "rgba(52,152,219,0.25)",
              borderColor: "rgba(52,152,219,1)",
              pointBackgroundColor: "rgba(52,152,219,1)",
              borderWidth: 2
            }
          ]
        },
        options: {
          scales: {
            r: {
              beginAtZero: true,
              suggestedMax: 100,
              ticks: { display: false },
              grid: { color: "#e5e7eb" },
              angleLines: { color: "#e5e7eb" },
              pointLabels: { font: { size: 11 }, color: "#4b5563" }
            }
          },
          plugins: {
            legend: { labels: { font: { size: 11 } } }
          }
        }
      });
    }

    // === ä¸‹æ–¹è¡¨æ ¼ï¼šå…¨éƒ¨æŒ‡æ¨™åˆ—å‡º ===
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";
    metricRows
      .slice()
      .sort((a, b) => {
        if (a.z == null && b.z == null) return 0;
        if (a.z == null) return 1;
        if (b.z == null) return -1;
        return b.z - a.z;
      })
      .forEach(row => {
        const tr = document.createElement("tr");
        let tagHtml = "â€”";
        if (row.z != null) {
          if (row.z >= 1) tagHtml = '<span class="tag good">å„ªæ–¼æ¨£æœ¬</span>';
          else if (row.z <= -0.5)
            tagHtml = '<span class="tag bad">å»ºè­°è£œå¼·</span>';
          else tagHtml = '<span class="tag mid">æ¥è¿‘å¹³å‡</span>';
        }
        tr.innerHTML = `
          <td>${row.label}</td>
          <td>${row.latest ?? "â€”"}</td>
          <td>${row.mean ?? "â€”"}</td>
          <td>${row.sd ?? "â€”"}</td>
          <td>${row.z != null ? row.z.toFixed(2) : "â€”"}</td>
          <td>${tagHtml}</td>
        `;
        tbody.appendChild(tr);
      });

    // === æ•™ç·´çŸ­è©• ===
    const strengths = metricRows
      .filter(r => r.z != null && r.z >= 1)
      .sort((a, b) => b.z - a.z)
      .slice(0, 3);
    const weaknesses = metricRows
      .filter(r => r.z != null && r.z <= -0.5)
      .sort((a, b) => a.z - b.z)
      .slice(0, 3);

    const listText = arr =>
      !arr.length
        ? "ç›®å‰å„é …æŒ‡æ¨™å¤§è‡´æ¥è¿‘åŒé½¡åœ‹éš›æ¨£æœ¬ï¼Œæ²’æœ‰ç‰¹åˆ¥çªå‡ºçš„å¼·é …æˆ–å¼±é …ã€‚"
        : arr.map(r => `${r.label}ï¼ˆZ = ${r.z.toFixed(2)}ï¼‰`).join("ã€");

    let comment = "";
    if (metricRows.some(r => r.z != null)) {
      comment = `
        æ ¹æ“šæœ¬æ¬¡æª¢æ¸¬æ•¸æ“šï¼Œ<strong>${name}</strong> èˆ‡ ${group || "ç›®å‰åˆ†ç´š"} åœ‹éš›æ¨£æœ¬ç›¸æ¯”ï¼š
        <br><br>
        ãƒ»ä¸»è¦<strong>å¼·é …</strong>æŒ‡æ¨™ï¼š${listText(strengths)}ã€‚<br>
        ãƒ»å»ºè­°å„ªå…ˆ<strong>è£œå¼·</strong>æŒ‡æ¨™ï¼š${listText(weaknesses)}ã€‚<br><br>
        è¨“ç·´è¦åŠƒä¸Šå¯å°‡ä¸Šè¿°è£œå¼·é …ç›®æ’å…¥æ¯é€±å›ºå®šè¨“ç·´å…§å®¹ï¼ŒåŒæ™‚ç¶­æŒå¼·é …çš„ç©©å®šåº¦ï¼Œ
        è®“é¸æ‰‹åœ¨æœªä¾†æ¯”è³½ä¸­æœ‰æ›´å…¨é¢çš„é«”èƒ½è¡¨ç¾ã€‚
      `;
    } else {
      comment = `
        ç›®å‰ã€Œåœ‹éš›æ¨™æº–ã€åˆ†é åªæœ‰å€é–“è³‡è¨Šæˆ–å°šæœªå¡«å…¥èª¤å·®å€¼ï¼Œæš«æ™‚ç„¡æ³•è¨ˆç®— Z åˆ†æ•¸ã€‚
        <br><br>
        å°±æœ¬æ¬¡æª¢æ¸¬åŸå§‹æˆç¸¾ä¾†çœ‹ï¼Œ<strong>${name}</strong> åœ¨å¤šæ•¸é«”èƒ½é …ç›®ä¸Šçš„è¡¨ç¾ç©©å®šï¼Œ
        å»ºè­°æ•™ç·´å…ˆæŒ‘é¸ 2ï½3 å€‹å¸Œæœ›çªå‡ºçš„èƒ½åŠ›ï¼ˆä¾‹å¦‚çˆ†ç™¼åŠ›ã€é€Ÿåº¦æˆ–æ•æ·åº¦ï¼‰ï¼Œ
        åšç‚ºä¸‹ä¸€éšæ®µè¨“ç·´é‡é»ï¼Œä¸¦æŒçºŒç´€éŒ„å¾ŒçºŒæ¸¬é©—ä»¥è§€å¯Ÿè®ŠåŒ–ã€‚
      `;
    }
    document.getElementById("coachComment").innerHTML = comment;

    status.textContent = "";
    report.style.display = "block";
  }
</script>
</body>
</html>
